{"version":3,"file":"static/js/login.6ff5735e.chunk.js","mappings":"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","sources":["api/config.js","api/index.js","utils/response.js","views/Login/Login.jsx","views/Login/index.js"],"sourcesContent":["// 考虑到网站可能有好几个域名，所以单独提出来\n\n// export const API = 'http://' + document.domain + ':8000';\nexport const API = \"http://129.94.175.234:5000\";\n","import axios from \"axios\";\n\n// 这里取决于登录的时候将 token 存储在哪里\nlet token = localStorage.getItem(\"token\");\n\nconst instance = axios.create({\n  timeout: 100000,\n  headers: {\n    \"Cache-Control\": \"no-cache\",\n    Pragma: \"no-cache\"\n  }\n});\n\n// 设置post请求头\n// instance.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\n\n// 添加请求拦截器\ninstance.interceptors.request.use(\n  config => {\n    // 将 token 添加到请求头\n    token && (config.headers.Authorization = token);\n    // 禁止缓存\n    config.params = {\n      timestamp: get_timestamp(),\n      ...config.params\n    };\n    return config;\n  },\n  error => {\n    return Promise.reject(error);\n  }\n);\n\n// 添加响应拦截器\ninstance.interceptors.response.use(\n  response => {\n    if (response.status === 200) {\n      return Promise.resolve(response);\n    } else {\n      return Promise.reject(response);\n    }\n  },\n  error => {\n    // 相应错误处理\n    // 比如： token 过期， 无权限访问， 路径不存在， 服务器问题等\n    switch (error.response.status) {\n      case 400:\n        error.response.message = error.response.data.message;\n        break;\n      case 401:\n        error.response.message = \"Unauthorized(401)\";\n        break;\n      case 403:\n        error.response.message = \"Access Denied(403)\";\n        break;\n      case 404:\n        error.response.message = \"Request Error(404)\";\n        break;\n      case 408:\n        error.response.message = \"Request Timeout(408)\";\n        break;\n      case 500:\n        error.response.message = \"Server Error(500)\";\n        break;\n      case 501:\n        error.response.message = \"Service Not Implemented(501)\";\n        break;\n      case 502:\n        error.response.message = \"Network Error(502)\";\n        break;\n      case 503:\n        error.response.message = \"Service is not available(503)\";\n        break;\n      case 504:\n        error.response.message = \"Timeout(504)\";\n        break;\n      case 505:\n        error.response.message = \"HTTP does not support(505)\";\n        break;\n      default:\n        error.response.message = `Connect error(${error.response.status})!`;\n    }\n    return Promise.reject(error);\n  }\n);\n\nfunction get_timestamp() {\n  let date = new Date();\n  let now_utc = Date.UTC(\n    date.getUTCFullYear(),\n    date.getUTCMonth(),\n    date.getUTCDate(),\n    date.getUTCHours(),\n    date.getUTCMinutes(),\n    date.getUTCSeconds()\n  );\n  return new Date(now_utc).getTime();\n}\n\nexport default instance;\n","import { message } from \"antd\";\n\nconst process_response = (err, msg = null) => {\n  try {\n    if (err.response.message === \"Network Error\") {\n      message.error(\"请求超时，请刷新重试!\");\n    }\n    switch (err.response.status) {\n      case 400:\n        msg = err.response.data.message;\n        break;\n      case 401:\n        msg = \"未授权，请重新登录(401)\";\n        this.props.history.push(\"/login\");\n        break;\n      case 403:\n        msg = \"拒绝访问(403)\";\n        break;\n      case 404:\n        msg = \"请求出错(404)\";\n        break;\n      case 408:\n        msg = \"请求超时(408)\";\n        break;\n      case 500:\n        msg = \"服务器错误(500)\";\n        break;\n      case 501:\n        msg = \"服务未实现(501)\";\n        break;\n      case 502:\n        msg = \"网络错误(502)\";\n        break;\n      case 503:\n        msg = \"服务不可用(503)\";\n        break;\n      case 504:\n        msg = \"网络超时(504)\";\n        break;\n      case 505:\n        msg = \"HTTP版本不受支持(505)\";\n        break;\n      default:\n        msg = `连接出错(${err.response.status})!`;\n    }\n    message.error(msg);\n  } catch (e) {\n    message.error(msg);\n  }\n};\n\nexport default process_response;\n","import React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport axios from \"@/api\";\nimport { API } from \"@/api/config\";\nimport process_response from \"@/utils/response\";\nimport { Layout, Input, Icon, Form, Button, Divider } from \"antd\";\n\nimport \"@/style/view-style/login.scss\";\n\nclass Login extends Component {\n  state = {\n    loading: false,\n    visible: false,\n    modalLoading: false\n  };\n\n  handleSubmit = e => {\n    e.preventDefault();\n    this.props.form.validateFields((err, values) => {\n      if (!err) {\n        let { username, password } = values;\n        axios\n          .post(`${API}/user/login`, { username, password })\n          .then(res => {\n            localStorage.clear();\n            localStorage.setItem(\"token\", res.data.token);\n            setTimeout(() => {\n              window.location.href = \"/\";\n            }, 200);\n          })\n          .catch(error => {\n            process_response(error, \"\");\n          });\n      }\n    });\n  };\n\n  check_password = (rule, value, callback) => {\n    let p1 = this.props.form.getFieldValue(\"fpassword1\");\n    let p2 = this.props.form.getFieldValue(\"fpassword2\");\n\n    // console.log(p1, p2);\n    if (p1 !== p2) {\n      callback(new Error(\"Password not same\"));\n    } else {\n      callback();\n    }\n  };\n\n  componentDidMount() {\n    window.localStorage.clear();\n  }\n\n  render() {\n    const { getFieldDecorator } = this.props.form;\n    return (\n      <Layout className=\"login animated fadeIn\">\n        {/* 登陆的div */}\n        <div className=\"model\">\n          <div className=\"login-form\">\n            <h3>DKRMS Login</h3>\n            <Divider />\n            <Form onSubmit={this.handleSubmit}>\n              <Form.Item>\n                {getFieldDecorator(\"username\", {\n                  rules: [{ required: true, message: \"Username\" }]\n                })(\n                  <Input\n                    prefix={\n                      <Icon type=\"user\" style={{ color: \"rgba(0,0,0,.25)\" }} />\n                    }\n                    placeholder=\"Username\"\n                  />\n                )}\n              </Form.Item>\n              <Form.Item>\n                {getFieldDecorator(\"password\", {\n                  rules: [{ required: true, message: \"Password\" }]\n                })(\n                  <Input\n                    prefix={\n                      <Icon type=\"lock\" style={{ color: \"rgba(0,0,0,.25)\" }} />\n                    }\n                    type=\"password\"\n                    placeholder=\"Password\"\n                  />\n                )}\n              </Form.Item>\n              <Form.Item>\n                <Button\n                  type=\"primary\"\n                  htmlType=\"submit\"\n                  className=\"login-form-button\"\n                  loading={this.state.loading}\n                >\n                  Login\n                </Button>\n              </Form.Item>\n            </Form>\n          </div>\n        </div>\n      </Layout>\n    );\n  }\n}\n\nexport default withRouter(Form.create()(Login));\n","import Login from \"./Login.jsx\";\nexport default Login;\n"],"names":["API","token","localStorage","getItem","instance","axios","timeout","headers","Pragma","get_timestamp","date","Date","now_utc","UTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getTime","interceptors","request","use","config","Authorization","params","timestamp","error","Promise","reject","response","status","resolve","message","data","err","msg","props","history","push","e","Login","state","loading","visible","modalLoading","handleSubmit","preventDefault","form","validateFields","values","username","password","then","res","clear","setItem","setTimeout","window","location","href","catch","process_response","check_password","rule","value","callback","getFieldValue","Error","getFieldDecorator","this","className","onSubmit","rules","required","prefix","type","style","color","placeholder","htmlType","Component","withRouter"],"sourceRoot":""}